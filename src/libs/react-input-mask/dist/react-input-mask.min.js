!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("react")):"function"==typeof define&&define.amd?define(["react"],t):e.ReactInputMask=t(e.React)}(this,function(e){"use strict";function t(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function n(){return(n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e}).apply(this,arguments)}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var o={9:"[0-9]",a:"[A-Za-z]","*":"[A-Za-z0-9]"},a="_";function r(e,t,n){if(t===undefined&&(t=a),null==n&&(n=o),!e||"string"!=typeof e)return{maskChar:t,formatChars:n,mask:null,prefix:null,lastEditablePos:null,permanents:[]};var s="",r="",i=[],u=!1,l=null;return e.split("").forEach(function(e){u||"\\"!==e?(u||!n[e]?(i.push(s.length),s.length===i.length-1&&(r+=e)):l=s.length+1,s+=e,u=!1):u=!0}),{maskChar:t,formatChars:n,prefix:r,mask:s,lastEditablePos:l,permanents:i}}function i(e,t){return-1!==e.permanents.indexOf(t)}function u(e,t,n){var s=e.mask,o=e.formatChars;if(!n)return!1;if(i(e,t))return s[t]===n;var a=o[s[t]];return new RegExp(a).test(n)}function l(e,t){return t.split("").every(function(t,n){return i(e,n)||!u(e,n,t)})}function p(e,t){var n=e.maskChar,s=e.prefix;if(!n){for(;t.length>s.length&&i(e,t.length-1);)t=t.slice(0,t.length-1);return t.length}for(var o=s.length,a=t.length;a>=s.length;a--){var r=t[a];if(!i(e,a)&&u(e,a,r)){o=a+1;break}}return o}function f(e,t){return p(e,t)===e.mask.length}function h(e,t){var n=e.maskChar,s=e.mask,o=e.prefix;if(!n){for((t=m(e,"",t,0)).length<o.length&&(t=o);t.length<s.length&&i(e,t.length);)t+=s[t.length];return t}if(t)return m(e,h(e,""),t,0);for(var a=0;a<s.length;a++)i(e,a)?t+=s[a]:t+=n;return t}function c(e,t,n,s){var o=n+s,a=e.maskChar,r=e.mask,u=e.prefix,l=t.split("");if(!a){for(var p=o;p<l.length;p++)i(e,p)&&(l[p]="");return n=Math.max(u.length,n),l.splice(n,o-n),t=l.join(""),h(e,t)}return l.map(function(t,s){return s<n||s>=o?t:i(e,s)?r[s]:a}).join("")}function m(e,t,n,s){var o=e.mask,a=e.maskChar,r=e.prefix,l=n.split(""),p=f(e,t),c=function(t,n){return!a||!i(e,n)||t!==a};return!a&&s>t.length&&(t+=o.slice(t.length,s)),l.every(function(n){for(;f=n,i(e,l=s)&&f!==o[l];){if(s>=t.length&&(t+=o[s]),!c(n,s))return!0;if(++s>=o.length)return!1}var l,f;return!u(e,s,n)&&n!==a||(s<t.length?a||p||s<r.length?t=t.slice(0,s)+n+t.slice(s+1):(t=t.slice(0,s)+n+t.slice(s),t=h(e,t)):a||(t+=n),++s<o.length)}),t}function g(e){return(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(){return setTimeout(e,0)})(e)}return function(o){function a(n){var a;t(t(t(t(t(t(t(t(t(t(t(t(t(t(t(t(t(t(t(t(t(t(t(t(s(s(a=o.call(this,n)||this)),"lastCursorPos",null),"focused",!1),"isDOMElement",function(e){return"object"==typeof HTMLElement?e instanceof HTMLElement:1===e.nodeType&&"string"==typeof e.nodeName}),"getInputDOMNode",function(){var t=a.input;return t?a.isDOMElement(t)?t:e.findDOMNode(t):null}),"getInputValue",function(){var e=a.getInputDOMNode();return e?e.value:null}),"setInputValue",function(e){var t=a.getInputDOMNode();t&&(a.value=e,t.value=e)}),"getLeftEditablePos",function(e){for(var t=e;t>=0;--t)if(!i(a.maskOptions,t))return t;return null}),"getRightEditablePos",function(e){for(var t=a.maskOptions.mask,n=e;n<t.length;++n)if(!i(a.maskOptions,n))return n;return null}),"setCursorToEnd",function(){var e=p(a.maskOptions,a.value),t=a.getRightEditablePos(e);null!==t&&a.setCursorPos(t)}),"setSelection",function(e,t){void 0===t&&(t=0);var n=a.getInputDOMNode();if(n){var s=e+t;if("selectionStart"in n&&"selectionEnd"in n)n.selectionStart=e,n.selectionEnd=s;else{var o=n.createTextRange();o.collapse(!0),o.moveStart("character",e),o.moveEnd("character",s-e),o.select()}}}),"getSelection",function(){var e=a.getInputDOMNode(),t=0,n=0;if("selectionStart"in e&&"selectionEnd"in e)t=e.selectionStart,n=e.selectionEnd;else{var s=document.selection.createRange();s.parentElement()===e&&(t=-s.moveStart("character",-e.value.length),n=-s.moveEnd("character",-e.value.length))}return{start:t,end:n,length:n-t}}),"getCursorPos",function(){return a.getSelection().start}),"setCursorPos",function(e){a.setSelection(e,0),g(function(){a.setSelection(e,0)}),a.lastCursorPos=e}),"isFocused",function(){return a.focused}),"getStringValue",function(e){return e||0===e?e+"":""}),"getModifyMaskedValueConfig",function(){var e=a.maskOptions,t=e.mask,n=e.maskChar,s=e.permanents,o=e.formatChars;return{mask:t,maskChar:n,permanents:s,alwaysShowMask:!!a.props.alwaysShowMask,formatChars:o}}),"onKeyDown",function(e){a.backspaceOrDeleteRemoval=null,"function"==typeof a.props.onKeyDown&&a.props.onKeyDown(e);var t=e.key,n=e.ctrlKey,s=e.metaKey,o=e.defaultPrevented;if(!(n||s||o||"Backspace"!==t&&"Delete"!==t)){var r=a.getSelection();if(!("Backspace"===t&&r.end>0||"Delete"===t&&a.value.length>r.start))return;a.backspaceOrDeleteRemoval={key:t,selection:a.getSelection()}}}),"onChange",function(e){var t=s(s(a)).beforePasteState,n=a.props.beforeChange,o=a.maskOptions,r=o.mask,i=o.maskChar,u=o.lastEditablePos,l=o.prefix,f=a.getInputValue();if(t)return a.beforePasteState=null,void a.pasteText(t.value,f,t.selection,e);var k=a.value,v=a.getInputDOMNode();try{"function"==typeof v.matches&&v.matches(":-webkit-autofill")&&(k="")}catch(I){}var d,O,y=a.getSelection(),b=y.end,C=r.length,w=f.length,P=k.length;if(a.backspaceOrDeleteRemoval){var M="Delete"===a.backspaceOrDeleteRemoval.key;if(f=a.value,y=a.backspaceOrDeleteRemoval.selection,b=y.start,a.backspaceOrDeleteRemoval=null,y.length)f=c(a.maskOptions,f,y.start,y.length);else if(y.start<l.length||!M&&y.start===l.length)b=l.length;else{var E=M?a.getRightEditablePos(b):a.getLeftEditablePos(b-1);null!==E&&(i||(f=f.substr(0,p(a.maskOptions,f))),f=c(a.maskOptions,f,E,1),b=E)}}else if(w>P){var D=w-P,R=y.end-D;O=f.substr(R,D),b=R<u&&(1!==D||O!==r[R])?a.getRightEditablePos(R):R,f=f.substr(0,R)+f.substr(R+D),d=c(a.maskOptions,f,R,C-R),d=m(a.maskOptions,d,O,b),f=m(a.maskOptions,k,O,b),1!==D||b>=l.length&&b<u?(b=Math.max(p(a.maskOptions,d),b))<u&&(b=a.getRightEditablePos(b)):b<u&&b++}else if(w<P){var S=C-w,V=(O=f.substr(0,y.end))===k.substr(0,y.end);d=c(a.maskOptions,k,y.end,S),i&&(f=m(a.maskOptions,d,O,0)),d=c(a.maskOptions,d,y.end,C-y.end),d=m(a.maskOptions,d,O,0),V?b<l.length&&(b=l.length):(b=Math.max(p(a.maskOptions,d),b))<u&&(b=a.getRightEditablePos(b))}if(f=h(a.maskOptions,f),O||(O=null),"function"==typeof n){var x=n(f,b,O,a.getModifyMaskedValueConfig());f=x.value,b=x.cursorPosition}a.setInputValue(f),"function"==typeof a.props.onChange&&a.props.onChange(e),a.isWindowsPhoneBrowser?g(function(){a.setSelection(b,0)}):a.setCursorPos(b)}),"onFocus",function(e){var t=a.props.beforeChange,n=a.maskOptions,s=n.mask,o=n.prefix;if(a.focused=!0,s)if(a.value)p(a.maskOptions,a.value)<a.maskOptions.mask.length&&a.setCursorToEnd();else{var r=h(a.maskOptions,o),i=h(a.maskOptions,r),u=p(a.maskOptions,i),l=a.getRightEditablePos(u);if("function"==typeof t){var f=t(i,l,null,a.getModifyMaskedValueConfig());i=f.value,l=f.cursorPosition}var c=i!==e.target.value;c&&(e.target.value=i),a.value=i,c&&"function"==typeof a.props.onChange&&a.props.onChange(e),a.setCursorPos(l)}"function"==typeof a.props.onFocus&&a.props.onFocus(e)}),"onBlur",function(e){var t=a.props.beforeChange,n=a.maskOptions.mask;if(a.focused=!1,n&&!a.props.alwaysShowMask&&l(a.maskOptions,a.value)){var s="";if("function"==typeof t)s=t(s,null,null,a.getModifyMaskedValueConfig()).value;var o=s!==a.getInputValue();o&&a.setInputValue(s),o&&"function"==typeof a.props.onChange&&a.props.onChange(e)}"function"==typeof a.props.onBlur&&a.props.onBlur(e)}),"onMouseDown",function(e){if(!a.focused&&document.addEventListener){a.mouseDownX=e.clientX,a.mouseDownY=e.clientY,a.mouseDownTime=(new Date).getTime();document.addEventListener("mouseup",function t(e){if(document.removeEventListener("mouseup",t),a.focused){var n=Math.abs(e.clientX-a.mouseDownX),s=Math.abs(e.clientY-a.mouseDownY),o=Math.max(n,s),r=(new Date).getTime()-a.mouseDownTime;(o<=10&&r<=200||o<=5&&r<=300)&&a.setCursorToEnd()}})}"function"==typeof a.props.onMouseDown&&a.props.onMouseDown(e)}),"onPaste",function(e){"function"==typeof a.props.onPaste&&a.props.onPaste(e),e.defaultPrevented||(a.beforePasteState={value:a.getInputValue(),selection:a.getSelection()},a.setInputValue(""))}),"pasteText",function(e,t,n,s){var o=a.props.beforeChange,r=n.start;n.length&&(e=c(a.maskOptions,e,r,n.length));var l,p,f,h,g,k,v,d=(l=a.maskOptions,p=t,f=r,h=l.mask,g=l.maskChar,k=p.split(""),v=f,k.every(function(e){for(;n=e,i(l,t=f)&&n!==h[t];)if(++f>=h.length)return!1;var t,n;return(u(l,f,e)||e===g)&&f++,f<h.length}),f-v);if(e=m(a.maskOptions,e,t,r),r+=d,r=a.getRightEditablePos(r)||r,"function"==typeof o){var O=o(e,r,t,a.getModifyMaskedValueConfig());e=O.value,r=O.cursorPosition}a.setInputValue(e),s&&"function"==typeof a.props.onChange&&a.props.onChange(s),a.setCursorPos(r)}),"handleRef",function(e){a.input=e,"function"==typeof a.props.inputRef&&a.props.inputRef(e)});var f=n.mask,k=n.maskChar,v=n.formatChars,d=n.defaultValue,O=n.value,y=n.alwaysShowMask;return a.hasValue=null!=O,a.maskOptions=r(f,k,v),null==d&&(d=""),null==O&&(O=d),O=a.getStringValue(O),a.maskOptions.mask&&(y||O)&&(O=h(a.maskOptions,O)),a.value=O,a}var k,v,d=a.prototype;return d.componentDidMount=function(){var e,t,n;this.isWindowsPhoneBrowser=(e=new RegExp("windows","i"),t=new RegExp("phone","i"),n=navigator.userAgent,e.test(n)&&t.test(n)),this.maskOptions.mask&&this.getInputValue()!==this.value&&this.setInputValue(this.value),this.props.maxLength&&this.maskOptions.mask&&"object"==typeof console&&console.error&&console.error("react-input-mask: You shouldn't pass maxLength property to the masked input. It breaks masking and unnecessary because length is limited by the mask length.")},d.componentDidUpdate=function(){var e=this.props.beforeChange,t=this.maskOptions;if(this.hasValue=null!=this.props.value,this.maskOptions=r(this.props.mask,this.props.maskChar,this.props.formatChars),!this.maskOptions.mask)return this.backspaceOrDeleteRemoval=null,void(this.lastCursorPos=null);var n=this.lastCursorPos,s=this.maskOptions.mask&&this.maskOptions.mask!==t.mask,o=this.props.alwaysShowMask||this.isFocused(),a=this.hasValue?this.getStringValue(this.props.value):this.value;if(t.mask||this.hasValue||(a=this.getInputValue()),(s||this.maskOptions.mask&&(a||o))&&(a=h(this.maskOptions,a),s)){var i=p(this.maskOptions,a);(null===n||i<n)&&(n=f(this.maskOptions,a)?i:this.getRightEditablePos(i))}if(!this.maskOptions.mask||!l(this.maskOptions,a)||o||this.hasValue&&this.props.value||(a=""),"function"==typeof e){var u=e(a,n,null,this.getModifyMaskedValueConfig());a=u.value,n=u.cursorPosition}this.value=a,n!==this.lastCursorPos&&this.setCursorPos(n),this.maskOptions.mask&&this.getInputValue()!==this.value&&(this.setInputValue(this.value),this.forceUpdate())},d.render=function(){var t=this,s=this.props,o=(s.mask,s.alwaysShowMask,s.maskChar,s.formatChars,s.inputRef,s.beforeChange,function(e,t){if(null==e)return{};var n,s,o={},a=Object.keys(e);for(s=0;s<a.length;s++)n=a[s],t.indexOf(n)>=0||(o[n]=e[n]);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(s=0;s<r.length;s++)n=r[s],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(s,["mask","alwaysShowMask","maskChar","formatChars","inputRef","beforeChange"]));if(this.maskOptions.mask){if(!o.disabled&&!o.readOnly){["onChange","onKeyDown","onPaste","onMouseDown"].forEach(function(e){o[e]=t[e]})}null!=o.value&&(o.value=this.value)}return e.createElement("input",n({ref:this.handleRef},o,{onFocus:this.onFocus,onBlur:this.onBlur}))},v=o,(k=a).prototype.__proto__=v&&v.prototype,k.__proto__=v,a}((e=e&&e.hasOwnProperty("default")?e["default"]:e).Component)});
